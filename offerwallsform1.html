<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="" type="image/jpg"/>
    <title>Offer walls form - Add menu </title>

    <!-- Custom fonts for this template-->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="css/av-admin.min.css" rel="stylesheet">
<style>
    .modal-confirm {    
  color: #636363;
  width: 325px;
  font-size: 14px;
}
.modal-confirm .modal-content {
  padding: 20px;
  border-radius: 5px;
  border: none;
}
.modal-confirm .modal-header {
  border-bottom: none;   
  position: relative;
}
.modal-confirm h4 {
  text-align: center;
  font-size: 26px;
  margin: 30px 0 -15px;
}
.modal-confirm .form-control, .modal-confirm .btn {
  min-height: 40px;
  border-radius: 3px; 
}
.modal-confirm .close {
  position: absolute;
  top: -5px;
  right: -5px;
} 
.modal-confirm .modal-footer {
  border: none;
  text-align: center;
  border-radius: 5px;
  font-size: 13px;
} 
.modal-confirm .icon-box {
  color: #fff;    
  position: absolute;
  margin: 0 auto;
  left: 0;
  right: 0;
  top: -70px;
  width: 95px;
  height: 95px;
  border-radius: 50%;
  z-index: 9;
  background: #82ce34;
  padding: 15px;
  text-align: center;
  box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.1);
}
.modal-confirm .icon-box i {
  font-size: 58px;
  position: relative;
  top: 3px;
}
.modal-confirm.modal-dialog {
  margin-top: 80px;
}
.modal-confirm .btn {
  color: #fff;
  border-radius: 4px;
  background: #82ce34;
  text-decoration: none;
  transition: all 0.4s;
  line-height: normal;
  border: none;
}
.modal-confirm .btn:hover, .modal-confirm .btn:focus {
  background: #6fb32b;
  outline: none;
}
.trigger-btn {
  display: inline-block;
  margin: 100px auto;
}
</style>

</head>

<body class="bg-gradient-primary">

    <div class="container" >

        <!-- Outer Row -->
        <div class="row justify-content-center">

            <div class="col-xl-10 col-lg-12 col-md-9">

                <div class="card o-hidden border-0 shadow-lg my-5">
                    <div class="card-body p-0">
                        <!-- Nested Row within Card Body -->
                        <div class="row">
                            <div class="col-lg-6 d-none d-lg-block bg-login-image1"></div>
                            <div class="col-lg-6">
                                <div class="p-5">
                                    <div class="text-center">
                                        <h1 class="h4 text-gray-900 mb-4">ADD OFFER WALL </h1>
                                    </div>
                                    <form class="user"onsubmit="return false">
                                        <div class="form-group">
                                        	<h5>Access to</h5>
                                        	<h4 id="error" style= "color:red"> </h4>
                                            <input type="radio" name="accessto" value='everyuser'>&nbsp Every user &nbsp
                                            <input type="radio" name="accessto" value='newuser'>&nbsp New User
                                        </div>
                                        
                                        
                                        <div class="form-group">
                                          <input type="text" class="form-control form-control-user"
                                                id="c" placeholder="Restaurant Name" required="required">
                                        </div>
                                        <div class="form-group">
                                            <input type="text" class="form-control form-control-user"
                                                id="d" placeholder="Offer Name" required="required">
                                        </div>
                                        <div class="form-group">
                                          <input type="text" class="form-control form-control-user"
                                              id="e" placeholder="Food Name" required="required">
                                      </div>
                                      <div class="form-group">
                                        <input type="text" class="form-control form-control-user"
                                            id="x" placeholder="Food price" required="required">
                                    </div>
                                        <div class="form-group">
                                            <input type="text" class="form-control form-control-user"
                                                id="f" placeholder="Offer price" required="required">
                                        </div>
                                        
                                        <div class="form-group">
                                          <h5>Offer validity period</h5>
                                          <input type="datetime-local" class="form-control form-control-user"
                                              id="dt" required="required">
                                      </div>

                                       <button id ='p1' class="btn btn-primary btn-user btn-block" onclick='validate()'>Add Coupon</button>
                                       <p style="visibility: hidden;" id='p2'>  <a href="#myModal"  data-toggle="modal"> <button class="btn btn-primary btn-user btn-block" onclick='save(),save1()' id='btn1'>
                                        Register
                                     </button></a></p>
                                        <hr>
                                       
                                    </form>
                                    <hr>
                                    <div class="text-center">
                                        <a href="add_menu(with_image_adding)starappdevlivery (1).html" class="btn btn-primary btn-user btn-block">
                                            Go back
                                         </a>
                                         <hr>

                                    </div>
                                   
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>

    </div>
<div class="text-center">
  <!-- Button HTML (to Trigger Modal) -->
  
</div>

<!-- Modal HTML -->
<div id="myModal" class="modal fade">
  <div class="modal-dialog modal-confirm">
    <div class="modal-content">
      <div class="modal-header">
        <div class="icon-box">
          <i class="material-icons">&#xE876;</i>
        </div>        
        <h4 class="modal-title w-100">Awesome!</h4> 
      </div>
      <div class="modal-body">
        <p class="text-center">Coupon details  has been successfully added.</p>
      </div>
      <div class="modal-footer">
              <a class="btn btn-success btn-block"href='add_menu(with_image_adding)starappdevlivery (1).html'>OK</a>
      </div>
    </div>
  </div>
</div> 

    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/av-admin.min.js"></script>
    
     <script src="https://www.gstatic.com/firebasejs/8.5.0/firebase-app.js"></script>
   <script src="https://www.gstatic.com/firebasejs/8.5.0/firebase-database.js"></script>
  <script type="text/javascript">
  
  // Your web app's Firebase configuration
// Initialize Firebase
/*
function getcoordinates(){
var address =  document.getElementById('f').value;
var theurl = "https://geocoder.ls.hereapi.com/6.2/geocode.json?apiKey=3_h1uPumgaSn62Onibdsb4RO1jXB5udqPA9AjGBULWM&searchtext="+address;
var xmlHttp =  new XMLHttpRequest();
xmlHttp.open('GET',theurl,false);
xmlHttp.send(null);
var json = JSON.parse(xmlHttp.responseText);
console.log(json);
document.getElementById('a').value=json.Response.View[0].Result[0].Location.DisplayPosition.Latitude;
document.getElementById('b').value=json.Response.View[0].Result[0].Location.DisplayPosition.Longitude;

}
*/
var firebaseConfig = {
  //here i have use develope project
  
  apiKey: "AIzaSyBGQsw6dLVCQ_utGY7SHLBfg7EckVz9W0o",
    authDomain: "star-delivery-38f25.firebaseapp.com",
    databaseURL: "https://star-delivery-38f25-default-rtdb.firebaseio.com",
    projectId: "star-delivery-38f25",
    storageBucket: "star-delivery-38f25.appspot.com",
    messagingSenderId: "351160619379",
    appId: "1:351160619379:web:9de85e6098b55a5ace7506"
  };
  firebase.initializeApp(firebaseConfig);

// Set database variable
var database = firebase.database()
function validate(){
	var name = document.getElementById('c').value
  var email = document.getElementById('d').value
  var phone = document.getElementById('e').value
 var food = sessionStorage.getItem('offerfood');
  var urltosave=sessionStorage.getItem('offerurl');
  var imgurltosave=sessionStorage.getItem("foodimgurl");
 // console.log(food,urltosave,imgurltosave);
  //var result=urltosave.split('/');
  //document.getElementById('c').value=result[0];
  //document.getElementById('e').value=food;
   //var address = document.getElementById('f').value
   //var selectwork = document.querySelector('input[name="work"]:checked');
//var selectshift = document.querySelector('input[name="shift"]:checked'); 
var selectaccess = document.querySelector('input[name="accessto"]:checked');
if(name==null || email==null || phone==null || selectaccess==null||selectaccess==null){
	alert('please enter all details');
	document.getElementById("error").innerHTML= "*You have not selected*";
}
else{
	document.getElementById('p1').style.visibility='hidden';
	document.getElementById('p2').style.visibility='visible';

}

}
function save() {
	//geolocation functioning happens here
	//var address =  document.getElementById('f').value;
//  var couponname = document.getElementById('d').value
  //var restname = document.getElementById('c').value
  var foodnamee=sessionStorage.getItem('offerfood');
  var rate = sessionStorage.getItem('offerrate');
//var selectaccess = document.querySelector('input[name="accessto"]:checked');
var urltosave=sessionStorage.getItem('offerurl');
var fromtime =sessionStorage.getItem('offerfrom');
var totime=sessionStorage.getItem('offerto');
var imgurltosave=sessionStorage.getItem("foodimgurl");
var cusine=sessionStorage.getItem('offercuisine');
  //var type=sessionStorage.getItem('offertype');
  var selectcatg=sessionStorage.getItem('offercatg');

//var selectshift = document.querySelector('input[name="shift"]:checked');            
              
  //          if(selectaccess!= null ){
    //        	var accessto=selectaccess.value;
              //var shift=selectshift.value;
				  database.ref(urltosave+foodnamee).set({
				              foodname:foodnamee,
                      foodrate:rate,
                      availability:"yes",
                      starttime:fromtime,
                      endtime:totime,
                      foodimg: imgurltosave,
                      cuisine:cusine,
                      category:selectcatg,
                      offer:"yes"

				  })
        }

//}
function save1(){
  var Couponname = document.getElementById('d').value
  var urltosave=sessionStorage.getItem('offerurl');
  var result=urltosave.split('/');
  var Restname=sessionStorage.getItem('restaurantname');
  var foodnamee=sessionStorage.getItem('offerfood');
  var rate = document.getElementById('f').value;
  var selectaccess = document.querySelector('input[name="accessto"]:checked');
  var accessto=selectaccess.value;
  var date_time=document.getElementById('dt').value;
  var imgurltosave=sessionStorage.getItem("foodimgurl");
  var realrate=sessionStorage.getItem('offerrate');
  var cusine=sessionStorage.getItem('offercuisine');
  var type=sessionStorage.getItem('offertype');
  var catg=sessionStorage.getItem('offercatg');
  if(date_time==''){
    alert('Enter coupon Validation');
  }
  else{
    var str=date_time.split('T');
    var date=str[0];
    var time=str[1];
  }
   database.ref("RestaurantOffers/"+type+'/'+foodnamee+'/').set({
                      foodname:foodnamee,
                      offerprice:rate,
                      actualprice:realrate,
                      category:catg,
                      cuisine:cusine,
                      restaurant:Restname,
                      couponname:Couponname,
                      date:date,
                      time:time,
                      foodimg: imgurltosave


          })
  }


  //alert('saved, enter menu');
 // document.getElementById("btn1").style.visibility = "hidden";
  //document.getElementById("anchor").style.visibility = "visible";
   // document.getElementById("p").style.visibility = "visible";
function loadvalues(){
  var food = sessionStorage.getItem('offerfood');
  var urltosave=sessionStorage.getItem('offerurl');
  var imgurltosave=sessionStorage.getItem("foodimgurl");
  var fromtime =sessionStorage.getItem('offerfrom');
var totime=sessionStorage.getItem('offerto');
  //console.log(food,urltosave,imgurltosave,fromtime,totime);
  var result=urltosave.split('/');
  document.getElementById('c').value=sessionStorage.getItem('restaurantname');;
  document.getElementById('x').value=sessionStorage.getItem('offerrate');;
  document.getElementById('e').value=food;
}

    </script>
    <script type="text/javascript">
     window.addEventListener('load',loadvalues);
    </script>

</body>

</html>